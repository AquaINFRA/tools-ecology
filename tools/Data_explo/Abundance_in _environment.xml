<tool id="tool_environment" name="Abundance in environment" version="@VERSION@" profile = "20.01">
    <description>Show the abundance according to the location</description>
    <macros>
        <import>macro.xml</import>
    </macros>
    <expand macro="Explo_requirements"/>
    <command detect_errors="exit_code"><![CDATA[
        Rscript
            '$__tool_directory__/GraphAbundance_in _environment.r'
            '$input'
            '$latitude'
            '$longitude'
            '$abundance'
            '$individual'
            '$colnames'
            '$output_EA'
        ]]>
        </command>
        <inputs>
            <param name="input" type="data" format="tabular" label="Input table"/> 
            <param name="latitude" label="Select column containing latitudes " type="data_column" data_ref="input" numerical="True" multiple="False"/>
            <param name="longitude" label="Select column containing longitudes" type="data_column" data_ref="input" numerical="True" multiple="False"/>
            <param name="abundance" label="Select column containing abundances " type="data_column" data_ref="input" numerical="True" multiple="False"/>
            <param name="individual" type="text" label="The abundance of what are you computing ?"/>
            <param name="colnames" type="boolean" label="The first line of your dataframe represents the names of columns ?"/>
        </inputs>
        <outputs>
            <data name="output_EA" from_work_dir="mappy.png" format="png"/>
        </outputs>
        <tests>
            <test>
                <param name="input" value="Reel_life_survey_fish_modif.csv"/>
                <param name="latitude" value="9"/>
                <param name="longitude" value="10"/>
                <param name="abundance" value="18"/>
                <param name="colnames" value="true"/>
                <output name="output_EA" ftype="png">
                    <assert_contents>
                        <has_text text="PNG"/>
                    </assert_contents>
                </output>
            </test>
            <test>
                <param name="input" value="Reef_Life_Survey_Invertebrates_mp.csv"/>
                <param name="latitude" value="9"/>
                <param name="longitude" value="10"/>
                <param name="abundance" value="18"/>
                <param name="colnames" value="true"/>
                <output name="output_EA" ftype="png">
                    <assert_contents>
                        <has_text text="PNG"/>
                    </assert_contents>
                </output>
            </test>
        </tests>
        <expand macro="topic"/>
        <help><![CDATA[
==================
Maps the abundance 
==================


**What it does**
This tool computes the abundances of species according to there locations data:

- Maps the abundance

**Input description**
A tabular file with observation data. Must at least contain three columns
which associate abundance, latitude and longitude or 'abundance', 'latitude' and 'longitude' with species ID.

+----------+-----------+--------------+------------+
| latitude | longitude | species.code |   number   |
+==========+===========+==============+============+
| lat      |long       |   speciesID  |      4     |
+----------+-----------+--------------+------------+
|  ...     |    ...    |      ...     |     ...    |
+----------+-----------+--------------+------------+

**Output**
A png file with every abundance dots for each location such as the image following

.. image::envi_abond.png

    ]]></help>
<expand macro="book_bibref"/>
            
</tool>
