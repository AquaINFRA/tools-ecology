<tool id="eal_table_template" name="Make templates for data tables" version="0.1.0+galaxy0" profile="22.05">
    <description>attributes and categorical variables for EML metadata creation</description>
    <requirements>
        <requirement type="package" version="4.3.1">r-base</requirement>
        <requirement type="package" version="3.5.5">r-emlassemblyline</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
    
    #set $table = ""
    mkdir data_files && 
    #for $indata in $inputdata
        ln -s '$indata' 'data_files/${indata.element_identifier}' &&
        #set $table += $indata.element_identifier + " "
    #end for
    
    Rscript 
         '$__tool_directory__/table_templates.R'
         '$table'
    
    ]]></command>
    <inputs>
         <param name="inputdata" type="data_collection"  collection_type="list"  label="Upload all data files wich are data table" help= "Input a data collection."/>
    </inputs>
    <outputs>
       <collection name="templates" type="list" label="Templates for data table">
             <discover_datasets pattern="__designation_and_ext__"/>
       </collection>
    </outputs>
    <tests>
        <test>
           <param name="inputdata">
              <collection type="list">
                 <element name="datafile_1.tsv" value="datafile_1.tsv" />
              </collection>
           </param>          
           <output_collection name='templates' type = "list" count="2"/>
        </test>
    </tests>
    <help><![CDATA[

To use this tool, you need to select, in your history a data collection with your data table (one or more).To do so, you can select the **Upload file** tool, select the *Collection* tab, upload all your templates, click on the *Start* button to integrate the files to Galaxy and then click on *Build*. You will need to choose a name and select *Create collection* to build a collection with your templates.
You also can upload your files to Galaxy, select them in the history by clicking the *Select items* button, click on the newly appeared box on the right and select *Build dataset list*.

    ]]></help>
</tool>
